{{define "categories/test_category"}}
  {{if gt (len .Error) 0 }}
    {{template "error" .Error}}
  {{else}}
    {{if eq .Total 0}}
      <!-- No matches result -->
      <div class="card no-matches">
        <div class="card-header">
          <h3>No Matching Transactions</h3>
          <div class="pattern-badge">{{.Pattern}}</div>
        </div>
        <div class="empty-state">
          <div class="empty-icon">üîç</div>
          <p>Your pattern didn't match any uncategorized transactions.</p>
          <p>Try a different pattern or check if all similar transactions are already categorized.</p>
        </div>
      </div>
    {{else}}
      <!-- Success result with matched transactions -->
      <div class="card success">
        <div class="card-header">
          <h3>Pattern Matched <span class="match-count">{{.Total}}</span> Transactions</h3>
          <div class="pattern-badge">{{.Pattern}}</div>
        </div>
        <div class="matched-transactions">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              {{$maxShown := 5}}
              {{range $index, $expense := .Results}}
                {{if lt $index $maxShown}}
                  <tr>
                    <td>{{$expense.Date.Format "2006-01-02"}}</td>
                    <td>{{$expense.Description}}</td>
                    {{if gt $expense.Amount 0}}
                      <td class="income">{{formatMoney $expense.Amount "." ","}}‚Ç¨</td>
                    {{else}}
                      <td class="expense">{{formatMoney $expense.Amount "." ","}}‚Ç¨</td>
                    {{end}}
                  </tr>
                {{end}}
              {{end}}
            </tbody>
          </table>
          
          <!-- Show when there are more matches than shown -->
          {{if gt .Total $maxShown}}
            <div class="more-matches">And {{sub .Total $maxShown}} more transactions</div>
          {{end}}
        </div>
        
        <div class="result-actions">
          <button hx-post="/category" 
                  hx-include="input[name='name'],input[name='pattern']" 
                  hx-target="#page" hx-swap="outerHTML"
                  class="btn-primary">Create "{{.Name}}" Category</button>
        </div>
      </div>
    {{end}}
  {{end}}
{{end}}
